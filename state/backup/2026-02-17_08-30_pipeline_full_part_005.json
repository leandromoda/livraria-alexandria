-js\\\";\\n\\ntype PageProps = {\\n  params: Promise<{\\n    slug: string;\\n  }>;\\n};\\n\\nexport default async function LivroPage({\\n  params,\\n}: PageProps) {\\n  const { slug } = await params;\\n\\n  const supabase = createClient(\\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\\n  );\\n\\n  /**\\n   * Livro + Categorias\\n   */\\n  const { data: livro } = await supabase\\n    .from(\\\"livros\\\")\\n    .select(`\\n      *,\\n      livros_categorias (\\n        categorias (\\n          nome,\\n          slug\\n        )\\n      )\\n    `)\\n    .eq(\\\"slug\\\", slug)\\n    .single();\\n\\n  if (!livro) {\\n    notFound();\\n  }\\n\\n  /**\\n   * Ofertas\\n   */\\n  const { data: ofertas } = await supabase\\n    .from(\\\"ofertas\\\")\\n    .select(`\\n      id,\\n      preco,\\n      marketplace\\n    `)\\n    .eq(\\\"livro_id\\\", livro.id)\\n    .eq(\\\"ativa\\\", true);\\n\\n  /**\\n   * Listas relacionadas\\n   */\\n  const { data: listasPivot } = await supabase\\n    .from(\\\"lista_livros\\\")\\n    .select(`\\n      listas (\\n        titulo,\\n        slug\\n      )\\n    `)\\n    .eq(\\\"livro_id\\\", livro.id);\\n\\n  const listas =\\n    listasPivot?.map((l: any) => l.listas) ?? [];\\n\\n  /**\\n   * Schema.org\\n   */\\n  const schema = {\\n    \\\"@context\\\": \\\"https://schema.org\\\",\\n    \\\"@type\\\": \\\"Product\\\",\\n    name: livro.titulo,\\n    description: livro.descricao,\\n    image: livro.imagem_url || undefined,\\n    sku: livro.isbn,\\n    brand: {\\n      \\\"@type\\\": \\\"Brand\\\",\\n      name: livro.autor,\\n    },\\n    additionalProperty: [\\n      {\\n        \\\"@type\\\": \\\"PropertyValue\\\",\\n        name: \\\"Autor\\\",\\n        value: livro.autor,\\n      },\\n      {\\n        \\\"@type\\\": \\\"PropertyValue\\\",\\n        name: \\\"Ano de publicação\\\",\\n        value: livro.ano_publicacao,\\n      },\\n    ],\\n    offers: ofertas?.map((o: any) => ({\\n      \\\"@type\\\": \\\"Offer\\\",\\n      price: o.preco,\\n      priceCurrency: \\\"BRL\\\",\\n      availability: \\\"https://schema.org/InStock\\\",\\n      url: `${process.env.NEXT_PUBLIC_SITE_URL}/api/click/${o.id}`,\\n      seller: {\\n        \\\"@type\\\": \\\"Organization\\\",\\n        name: o.marketplace,\\n      },\\n    })),\\n  };\\n\\n  return (\\n    <main className=\\\"max-w-3xl mx-auto px-6 py-10 space-y-10\\\">\\n\\n      {/* Schema JSON-LD */}\\n      <script\\n        type=\\\"application/ld+json\\\"\\n        dangerouslySetInnerHTML={{\\n          __html: JSON.stringify(schema),\\n        }}\\n      />\\n\\n      {/* =========================\\n          Livro\\n      ========================== */}\\n      <section className=\\\"space-y-4\\\">\\n\\n        <h1 className=\\\"text-3xl font-bold\\\">\\n          {livro.titulo}\\n        </h1>\\n\\n        {livro.autor && (\\n          <p className=\\\"text-lg text-gray-600\\\">\\n            por {livro.autor}\\n          </p>\\n        )}\\n\\n        {/* CAPA */}\\n        {livro.imagem_url && (\\n          <img\\n            src={livro.imagem_url}\\n            alt={livro.titulo}\\n            className=\\\"w-48 rounded\\\"\\n          />\\n        )}\\n\\n        {livro.descricao && (\\n          <p className=\\\"text-gray-800 leading-relaxed\\\">\\n            {livro.descricao}\\n          </p>\\n        )}\\n\\n      </section>\\n\\n      {/* =========================\\n          Categorias\\n      ========================== */}\\n      <section className=\\\"space-y-3\\\">\\n\\n        <h2 className=\\\"text-xl font-semibold\\\">\\n          Categorias\\n        </h2>\\n\\n        {!livro.livros_categorias?.length && (\\n          <p className=\\\"text-gray-500\\\">\\n            Ainda não categorizado.\\n          </p>\\n        )}\\n\\n        <ul className=\\\"list-disc list-inside text-sm space-y-1\\\">\\n\\n          {livro.livros_categorias?.map((rel: any) => (\\n\\n            <li key={rel.categorias.slug}>\\n\\n              <a\\n                href={`/categorias/${rel.categorias.slug}`}\\n                className=\\\"text-blue-600 hover:underline\\\"\\n              >\\n                {rel.categorias.nome}\\n              </a>\\n\\n            </li>\\n\\n          ))}\\n\\n        </ul>\\n\\n      </section>\\n\\n      {/* =========================\\n          Listas relacionadas\\n      ========================== */}\\n      <section className=\\\"space-y-4\\\">\\n\\n        <h2 className=\\\"text-2xl font-semibold\\\">\\n          Este livro aparece nas listas\\n        </h2>\\n\\n        {!listas.length && (\\n          <p className=\\\"text-gray-500\\\">\\n            Ainda não vinculado a listas editoriais.\\n          </p>\\n        )}\\n\\n        <ul className=\\\"list-disc list-inside space-y-1\\\">\\n\\n          {listas.map((lista: any) => (\\n\\n            <li key={lista.slug}>\\n              <a\\n                href={`/listas/${lista.slug}`}\\n                className=\\\"text-blue-600 hover:underline\\\"\\n              >\\n                {lista.titulo}\\n              </a>\\n            </li>\\n\\n          ))}\\n\\n        </ul>\\n\\n      </section>\\n\\n      {/* =========================\\n          Ofertas\\n      ========================== */}\\n      <section className=\\\"space-y-4\\\">\\n\\n        <h2 className=\\\"text-2xl font-semibold\\\">\\n          Onde comprar\\n        </h2>\\n\\n        {!ofertas?.length && (\\n          <p className=\\\"text-gray-500\\\">\\n            Nenhuma oferta disponível no momento.\\n          </p>\\n        )}\\n\\n        <ul className=\\\"space-y-3\\\">\\n\\n          {ofertas?.map((o: any) => (\\n\\n            <li\\n              key={o.id}\\n              className=\\\"border p-4 rounded-lg flex items-center justify-between\\\"\\n            >\\n\\n              <div>\\n                <p className=\\\"font-medium\\\">\\n                  {o.marketplace}\\n                </p>\\n\\n                <p className=\\\"text-lg font-bold\\\">\\n                  R$ {o.preco}\\n                </p>\\n              </div>\\n\\n              <a\\n                href={`/api/click/${o.id}`}\\n                target=\\\"_blank\\\"\\n                className=\\\"text-sm text-green-600 hover:underline\\\"\\n              >\\n                Ver oferta →\\n              </a>\\n\\n            </li>\\n\\n          ))}\\n\\n        </ul>\\n\\n      </section>\\n\\n    </main>\\n  );\\",
    "state\\2026-02-16_10-01_site_bootstrap_part_002.json": "n}\\n\",\n    \"app\\\\(public)\\\\ofertas\\\\data.mock.ts\": \"export const ofertasMock = [\\n  {\\n    id: 1,\\n    titulo: \\\"O Investidor Inteligente\\\",\\n    slug: \\\"o-investidor-inteligente\\\",\\n    afiliado_id: \\\"8535930321\\\",\\n    preco: 59.9,\\n    preco_original: 89.9,\\n  },\\n  {\\n    id: 2,\\n    titulo: \\\"Ação Humana\\\",\\n    slug: \\\"acao-humana\\\",\\n    afiliado_id: \\\"8593751422\\\",\\n    preco: 74.9,\\n    preco_original: null,\\n  },\\n];\\n\",\n    \"app\\\\(public)\\\\ofertas\\\\data.ts\": \"import { ofertasMock } from \\\"./data.mock\\\";\\nimport { createClient } from \\\"@supabase/supabase-js\\\";\\n\\ntype Oferta = {\\n  id: number;\\n  titulo: string;\\n  slug: string;\\n  preco: number;\\n  url_afiliada: string;\\n};\\n\\nexport async function getOfertas(): Promise<Oferta[]> {\\n  const useMock = process.env.NEXT_PUBLIC_USE_MOCK === \\\"true\\\";\\n\\n  if (useMock) {\\n    return ofertasMock;\\n  }\\n\\n  const supabase = createClient(\\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\\n  );\\n\\n  const { data, error } = await supabase\\n    .from(\\\"ofertas\\\")\\n    .select(`\\n      id,\\n      preco,\\n      url_afiliada,\\n      livros (\\n        titulo,\\n        slug\\n      )\\n    `)\\n    .order(\\\"id\\\", { ascending: false });\\n\\n  if (error) {\\n    throw new Error(error.message);\\n  }\\n\\n  /**\\n   * Flatten do JOIN\\n   */\\n  const parsed: Oferta[] =\\n    data?.map((o: any) => ({\\n      id: o.id,\\n      preco: o.preco,\\n      url_afiliada: o.url_afiliada,\\n      titulo: o.livros?.titulo ?? \\\"Sem título\\\",\\n      slug: o.livros?.slug ?? \\\"#\\\",\\n    })) ?? [];\\n\\n  return parsed;\\n}\\n\",\n    \"app\\\\(public)\\\\ofertas\\\\page.tsx\": \"export const runtime = \\\"edge\\\";\\n\\nimport { createClient } from \\\"@supabase/supabase-js\\\";\\n\\nexport default async function OfertasPage() {\\n  const supabase = createClient(\\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\\n  );\\n\\n  /**\\n   * Ofertas + Livro\\n   */\\n  const { data: ofertas } = await supabase\\n    .from(\\\"ofertas\\\")\\n    .select(`\\n      id,\\n      preco,\\n      marketplace,\\n      livros (\\n        titulo,\\n        slug,\\n        autor,\\n        imagem_url,\\n        isbn\\n      )\\n    `)\\n    .eq(\\\"ativa\\\", true);\\n\\n  const baseUrl =\\n    process.env.NEXT_PUBLIC_SITE_URL ||\\n    \\\"http://localhost:3000\\\";\\n\\n  /**\\n   * =========================\\n   * Schema.org\\n   * =========================\\n   */\\n  const schema = {\\n    \\\"@context\\\": \\\"https://schema.org\\\",\\n    \\\"@type\\\": \\\"ItemList\\\",\\n    name: \\\"Ofertas de livros\\\",\\n    itemListElement: ofertas?.map(\\n      (o: any, index: number) => ({\\n        \\\"@type\\\": \\\"ListItem\\\",\\n        position: index + 1,\\n        item: {\\n          \\\"@type\\\": \\\"Product\\\",\\n          name: o.livros.titulo,\\n          image:\\n            o.livros.imagem_url || undefined,\\n          sku: o.livros.isbn,\\n          brand: {\\n            \\\"@type\\\": \\\"Brand\\\",\\n            name: o.livros.autor,\\n          },\\n          offers: {\\n            \\\"@type\\\": \\\"Offer\\\",\\n            price: o.preco,\\n            priceCurrency: \\\"BRL\\\",\\n            availability:\\n              \\\"https://schema.org/InStock\\\",\\n            url: `${baseUrl}/api/click/${o.id}`,\\n            seller: {\\n              \\\"@type\\\": \\\"Organization\\\",\\n              name: o.marketplace,\\n            },\\n          },\\n        },\\n      })\\n    ),\\n  };\\n\\n  return (\\n    <main className=\\\"max-w-3xl mx-auto px-6 py-10 space-y-6\\\">\\n      {/* Schema */}\\n      <script\\n        type=\\\"application/ld+json\\\"\\n        dangerouslySetInnerHTML={{\\n          __html: JSON.stringify(schema),\\n        }}\\n      />\\n\\n      <h1 className=\\\"text-3xl font-bold\\\">\\n        Ofertas de Livros\\n      </h1>\\n\\n      <ul className=\\\"space-y-4\\\">\\n        {ofertas?.map((o: any) => (\\n          <li\\n            key={o.id}\\n            className=\\\"border p-4 rounded-lg\\\"\\n          >\\n            <a\\n              href={`/livros/${o.livros.slug}`}\\n              className=\\\"text-lg font-semibold text-blue-600 hover:underline block\\\"\\n            >\\n              {o.livros.titulo}\\n            </a>\\n\\n            <p className=\\\"text-gray-700\\\">\\n              R$ {o.preco}\\n            </p>\\n\\n            <a\\n              href={`/api/click/${o.id}`}\\n              target=\\\"_blank\\\"\\n              className=\\\"text-sm text-green-600 hover:underline\\\"\\n            >\\n              Ver oferta →\\n            </a>\\n          </li>\\n        ))}\\n      </ul>\\n    </main>\\n  );\\n}\",\n    \"app\\\\teste\\\\[id]\\\\page.tsx\": \"export default function Teste({ params }: any) {\\n  return (\\n    <div style={{ padding: 40 }}>\\n      ID: {params?.id}\\n    </div>\\n  );\\n}\\n\",\n    \"lib\\\\supabase-admin.ts\": \"import { createClient } from \\\"@supabase/supabase-js\\\";\\n\\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\\nconst serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY!;\\n\\nexport const supabaseAdmin = createClient(\\n  supabaseUrl,\\n  serviceRoleKey,\\n  {\\n    auth: {\\n      persistSession: false\\n    }\\n  }\\n);\\n\",\n    \"lib\\\\supabase.ts\": \"import { createClient } from \\\"@supabase/supabase-js\\\";\\n\\nconst supabaseUrl =\\n  process.env.SUPABASE_URL ??\\n  process.env.NEXT_PUBLIC_SUPABASE_URL;\\n\\nconst supabaseAnonKey =\\n  process.env.SUPABASE_ANON_KEY ??\\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\\n\\nif (!supabaseUrl) {\\n  throw new Error(\\\"supabaseUrl is required.\\\");\\n}\\n\\nif (!supabaseAnonKey) {\\n  throw new Error(\\\"supabaseAnonKey is required.\\\");\\n}\\n\\nexport const supabase = createClient(\\n  supabaseUrl,\\n  supabaseAnonKey\\n);\",\n    \"lib\\\\supabase\\\\edge.ts\": \"import { createClient } from \\\"@supabase/supabase-js\\\";\\n\\nexport const supabaseEdge = createClient(\\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\\n  {\\n    auth: {\\n      persistSession: false,\\n    },\\n  }\\n);\"\n  }\n}",
    "state\\2026-02-17_08-30_site_bootstrap_part_001.json": "{\n  \"tree_site\": \"app\\napp\\\\(internal)\\napp\\\\(internal)\\\\api\\napp\\\\(internal)\\\\api\\\\click\\napp\\\\(internal)\\\\api\\\\click\\\\[id]\\napp\\\\(public)\\napp\\\\(public)\\\\autores\\napp\\\\(public)\\\\categorias\\napp\\\\(public)\\\\categorias\\\\[slug]\\napp\\\\(public)\\\\listas\\napp\\\\(public)\\\\listas\\\\[slug]\\napp\\\\(public)\\\\listas\\\\[slug]\\\\_components\\napp\\\\(public)\\\\listas\\\\[slug]\\\\_data\\napp\\\\(public)\\\\listas\\\\[slug]\\\\_graph\\napp\\\\(public)\\\\livros\\napp\\\\(public)\\\\livros\\\\[slug]\\napp\\\\(public)\\\\livros\\\\[slug]\\\\_components\\napp\\\\(public)\\\\livros\\\\[slug]\\\\_data\\napp\\\\(public)\\\\livros\\\\[slug]\\\\_graph\\napp\\\\(public)\\\\ofertas\\napp\\\\(public)\\\\ofertas\\\\_components\\napp\\\\(public)\\\\ofertas\\\\_data\\napp\\\\(public)\\\\tags\\napp\\\\teste\\napp\\\\teste\\\\[id]\\nlib\\nlib\\\\supabase\\npublic\",\n  \"project_state\": \"project_state.json não encontrado.\",\n  \"database_schema_abstract\": \"database_schema.json não encontrado.\",\n  \"files\": {\n    \"app\\\\globals.css\": \"@import \\\"tailwindcss\\\";\\n\\n:root {\\n  --background: #ffffff;\\n  --foreground: #171717;\\n}\\n\\n@theme inline {\\n  --color-background: var(--background);\\n  --color-foreground: var(--foreground);\\n  --font-sans: var(--font-geist-sans);\\n  --font-mono: var(--font-geist-mono);\\n}\\n\\n@media (prefers-color-scheme: dark) {\\n  :root {\\n    --background: #0a0a0a;\\n    --foreground: #ededed;\\n  }\\n}\\n\\nbody {\\n  background: var(--background);\\n  color: var(--foreground);\\n  font-family: Arial, Helvetica, sans-serif;\\n}\\n\",\n    \"app\\\\layout.tsx\": \"export const runtime = \\\"edge\\\";\\n\\nimport \\\"./globals.css\\\";\\n\\nexport default function RootLayout({\\n  children,\\n}: {\\n  children: React.ReactNode;\\n}) {\\n  return (\\n    <html lang=\\\"pt-BR\\\">\\n      <body>\\n\\n        {/* =========================\\n            NAVBAR GLOBAL\\n        ========================== */}\\n        <header className=\\\"border-b bg-white\\\">\\n\\n          <nav className=\\\"max-w-6xl mx-auto px-6 py-4 flex gap-6 text-sm font-medium\\\">\\n\\n            <a href=\\\"/\\\" className=\\\"hover:text-blue-600\\\">\\n              Home\\n            </a>\\n\\n            <a href=\\\"/listas\\\" className=\\\"hover:text-blue-600\\\">\\n              Listas\\n            </a>\\n\\n            <a href=\\\"/livros\\\" className=\\\"hover:text-blue-600\\\">\\n              Livros\\n            </a>\\n\\n            <a href=\\\"/ofertas\\\" className=\\\"hover:text-blue-600\\\">\\n              Ofertas\\n            </a>\\n\\n          </nav>\\n\\n        </header>\\n\\n        {/* PAGE */}\\n        <main>\\n          {children}\\n        </main>\\n\\n      </body>\\n    </html>\\n  );\\n}\\n\",\n    \"app\\\\(internal)\\\\api\\\\click\\\\[id]\\\\route.ts\": \"export const runtime = \\\"edge\\\";\\n\\nimport { NextResponse } from \\\"next/server\\\";\\nimport { createClient } from \\\"@supabase/supabase-js\\\";\\n\\nexport async function GET(\\n  req: Request,\\n  { params }: { params: { id: string } }\\n) {\\n  const offerId = params.id;\\n\\n  const supabase = createClient(\\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\\n    process.env.SUPABASE_SERVICE_ROLE_KEY!\\n  );\\n\\n  /**\\n   * 1) Buscar oferta + livro\\n   */\\n  const { data: oferta, error: ofertaError } =\\n    await supabase\\n      .from(\\\"ofertas\\\")\\n      .select(\\\"id, livro_id, url_afiliada\\\")\\n      .eq(\\\"id\\\", offerId)\\n      .single();\\n\\n  if (ofertaError || !oferta) {\\n    return new NextResponse(\\\"Oferta não encontrada\\\", {\\n      status: 404,\\n    });\\n  }\\n\\n  /**\\n   * 2) Metadados\\n   */\\n  const userAgent =\\n    req.headers.get(\\\"user-agent\\\") ?? null;\\n\\n  const referer =\\n    req.headers.get(\\\"referer\\\") ?? null;\\n\\n  const ip =\\n    req.headers.get(\\\"x-forwarded-for\\\") ??\\n    \\\"0.0.0.0\\\";\\n\\n  /**\\n   * 3) Hash IP (Edge-safe)\\n   */\\n  const hashBuffer = await crypto.subtle.digest(\\n    \\\"SHA-256\\\",\\n    new TextEncoder().encode(ip)\\n  );\\n\\n  const ipHash = Array.from(\\n    new Uint8Array(hashBuffer)\\n  )\\n    .map((b) => b.toString(16).padStart(2, \\\"0\\\"))\\n    .join(\\\"\\\");\\n\\n  /**\\n   * 4) Insert tracking\\n   */\\n  await supabase.from(\\\"oferta_clicks\\\").insert({\\n    oferta_id: oferta.id,\\n    livro_id: oferta.livro_id,\\n    user_agent: userAgent,\\n    referer: referer,\\n    ip_hash: ipHash,\\n  });\\n\\n  /**\\n   * 5) Redirect afiliado\\n   */\\n  return NextResponse.redirect(\\n    oferta.url_afiliada,\\n    302\\n  );\\n}\\n\",\n    \"app\\\\(public)\\\\page.tsx\": \"export const runtime = \\\"edge\\\";\\n\\nimport { createClient } from \\\"@supabase/supabase-js\\\";\\n\\nexport default async function Home() {\\n  const supabase = createClient(\\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\\n  );\\n\\n  /**\\n   * Listas (hub primário SEO)\\n   */\\n  const { data: listas } = await supabase\\n    .from(\\\"listas\\\")\\n    .select(\\\"titulo, slug\\\")\\n    .limit(6);\\n\\n  /**\\n   * Livros (discovery)\\n   */\\n  const { data: livros } = await supabase\\n    .from(\\\"livros\\\")\\n    .select(\\\"titulo, slug\\\")\\n    .limit(6);\\n\\n  /**\\n   * Ofertas (monetização)\\n   */\\n  const { data: ofertas } = await supabase\\n    .from(\\\"ofertas\\\")\\n    .select(`\\n      id,\\n      livros (\\n        titulo,\\n        slug\\n      )\\n    `)\\n    .eq(\\\"ativa\\\", true)\\n    .limit(6);\\n\\n  return (\\n    <main className=\\\"p-10 max-w-3xl mx-auto space-y-10\\\">\\n\\n      {/* =========================\\n          Header + Nav\\n      ========================== */}\\n      <header className=\\\"space-y-4\\\">\\n\\n        <h1 className=\\\"text-3xl font-bold\\\">\\n          Livraria Alexandria\\n        </h1>\\n\\n        <p className=\\\"text-lg text-gray-700\\\">\\n          [livros].\\n        </p>\\n\\n        {/* NAV PRIMÁRIA */}\\n        <nav className=\\\"flex gap-6 pt-2 text-blue-600 font-medium\\\">\\n          <a href=\\\"/listas\\\" className=\\\"hover:underline\\\">\\n            Ver todas as listas →\\n          </a>\\n\\n          <a href=\\\"/livros\\\" className=\\\"hover:underline\\\">\\n            Ver todos os livros →\\n          </a>\\n        </nav>\\n\\n      </header>\\n\\n      {/* =========================\\n          Listas\\n      ========================== */}\\n      <section className=\\\"space-y-4\\\">\\n        <h2 className=\\\"text-xl font-semibold\\\">\\n          Listas recomendadas\\n        </h2>\\n\\n        <ul className=\\\"list-disc list-inside space-y-1\\\">\\n          {listas?.map((l) => (\\n            <li key={l.slug}>\\n              <a\\n                href={`/listas/${l.slug}`}\\n                className=\\\"text-blue-600 hover:underline\\\"\\n              >\\n                {l.titulo}\\n              </a>\\n            </li>\\n          ))}\\n        </ul>\\n      </section>\\n\\n      {/* =========================\\n          Livros\\n      ========================== */}\\n      <section className=\\\"space-y-4\\\">\\n        <h2 className=\\\"text-xl font-semibold\\\">\\n          Livros em destaque\\n        </h2>\\n\\n        <ul className=\\\"list-disc list-inside space-y-1\\\">\\n          {livros?.map((l) => (\\n            <li key={l.slug}>\\n              <a\\n                href={`/livros/${l.slug}`}\\n                className=\\\"text-blue-600 hover:underline\\\"\\n              >\\n                {l.titulo}\\n              </a>\\n            </li>\\n          ))}\\n        </ul>\\n      </section>\\n\\n      {/* =========================\\n          Ofertas\\n      ========================== */}\\n      <section className=\\\"space-y-4\\\">\\n        <h2 className=\\\"text-xl font-semibold\\\">\\n          Ofertas ativas\\n        </h2>\\n\\n        <ul className=\\\"list-disc list-inside space-y-1\\\">\\n          {ofertas?.map((o: any) => (\\n            <li key={o.id}>\\n              <a\\n                href={`/livros/${o.livros.slug}`}\\n                className=\\\"text-blue-600 hover:underline\\\"\\n              >\\n                {o.livros.titulo}\\n              </a>\\n            </li>\\n          ))}\\n        </ul>\\n      </section>\\n\\n    </main>\\n  );\\n}\\n\",\n    \"app\\\\(public)\\\\categorias\\\\page.tsx\": \"export const runtime = \\\"edge\\\";\\n\\nimport { createClient } from \\\"@supabase/supabase-js\\\";\\n\\nexport default async function CategoriasPage() {\\n\\n  const supabase = createClient(\\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\\n  );\\n\\n  /**\\n   * Categorias + contagem\\n   */\\n  const { data: categorias } = await supabase\\n    .from(\\\"categorias\\\")\\n    .select(`\\n      id,\\n      nome,\\n      slug,\\n      livros_categorias (\\n        id\\n      )\\n    `)\\n    .order(\\\"nome\\\");\\n\\n  return (\\n    <main className=\\\"p-10 max-w-4xl mx-auto space-y-6\\\">\\n\\n      <h1 className=\\\"text-2xl font-bold\\\">\\n        Categorias\\n      </h1>\\n\\n      <ul className=\\\"space-y-3\\\">\\n\\n        {categorias?.map((cat: any) => {\\n\\n          const count =\\n            cat.livros_categorias?.length ?? 0;\\n\\n          return (\\n\\n            <li\\n              key={cat.slug}\\n              className=\\\"flex justify-between border p-4 rounded-lg\\\"\\n            >\\n\\n              <a\\n                href={`/categorias/${cat.slug}`}\\n                className=\\\"text-blue-600 hover:underline font-medium\\\"\\n              >\\n                {cat.nome}\\n              </a>\\n\\n              <span className=\\\"text-sm text-gray-500\\\">\\n                {count} livros\\n              </span>\\n\\n            </li>\\n\\n          );\\n\\n        })}\\n\\n      </ul>\\n\\n    </main>\\n  );\\n}\\n\",\n    \"app\\\\(public)\\\\categorias\\\\[slug]\\\\page.tsx\": \"export const runtime = \\\"edge\\\";\\n\\nimport { notFound } from \\\"next/navigation\\\";\\nimport { createClient } from \\\"@supabase/supabase-js\\\";\\n\\ntype PageProps = {\\n  params: Promise<{\\n    slug: string;\\n  }>;\\n};\\n\\nexport default async function CategoriaPage({\\n  params,\\n}: PageProps) {\\n\\n  const { slug } = await params;\\n\\n  const supabase = createClient(\\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\\n  );\\n\\n  /**\\n   * =========================\\n   * Categoria\\n   * =========================\\n   */\\n  const { data: categoria } = await supabase\\n    .from(\\\"categorias\\\")\\n    .select(\\\"id, nome, slug\\\")\\n    .eq(\\\"slug\\\", slug)\\n    .single();\\n\\n  if (!categoria) return notFound();\\n\\n  /**\\n   * =========================\\n   * Listas editoriais\\n   * =========================\\n   */\\n  const { data: listasEditorial } = await supabase\\n    .from(\\\"listas_categorias\\\")\\n    .select(`\\n      weight,\\n      listas (\\n        titulo,\\n        slug\\n      )\\n    `)\\n    .eq(\\\"categoria_id\\\", categoria.id)\\n    .order(\\\"weight\\\", { ascending: false });\\n\\n  const editoriais =\\n    listasEditorial?.map((l: any) => l.listas) ?? [];\\n\\n  /**\\n   * =========================\\n   * Livros da categoria\\n   * =========================\\n   */\\n  const { data: livrosPivot } = await supabase\\n    .from(\\\"livros_categorias\\\")\\n    .select(`\\n      livros (\\n        id,\\n        titulo,\\n        slug,\\n        imagem_url\\n      )\\n    `)\\n    .eq(\\\"categoria_id\\\", categoria.id);\\n\\n  const livros =\\n    livrosPivot?.map((l: any) => l.livros) ?? [];\\n\\n  /**\\n   * =========================\\n   * Listas automáticas\\n   * =========================\\n   */\\n  const livroIds = livros.map((l: any) => l.id);\\n\\n  let automati