{
  "meta": {
    "project_name": "Livraria Alexandria",
    "description": "Plataforma de livraria afiliada baseada em SEO programático, listas de decisão e páginas de livros, com monetização via redirecionamento afiliado.",
    "current_phase": "pilot_functional_interlinked_taxonomy_active",
    "last_updated": "2026-02-14",
    "owner": "Leandro Moda",
    "environment": "local",
    "runtime_stack": {
      "node": "Next.js App Router (Edge Runtime ativo)",
      "database_primary": "Supabase",
      "database_staging": "SQLite (pipeline local)",
      "llm_local": "Ollama",
      "llm_model": "phi3:mini",
      "python_env": "venv (Windows)",
      "ingest_language": "Python 3.14"
    }
  },

  "objectives": {
    "primary": "Piloto funcional monetizável com interlinking entre listas, livros, categorias e ofertas.",
    "secondary": [
      "Validar funil Lista → Livro → Oferta → Afiliado",
      "Validar JOIN ofertas ↔ livros",
      "Estabelecer malha mínima de interlinking",
      "Ativar taxonomia navegável",
      "Preparar base para tracking afiliado",
      "Escalar geração programática via ingest"
    ],
    "non_goals": [
      "Checkout próprio",
      "Gestão de estoque",
      "Autenticação de usuários finais nesta fase"
    ]
  },

  "architecture": {
    "high_level_description": "Aplicação monolítica em Next.js (App Router) com pipeline externo modular em Python.",

    "route_groups": {
      "public": "Páginas indexáveis e SEO",
      "internal": "Infraestrutura e APIs"
    },

    "modules": [
      {
        "name": "Páginas de Livro",
        "status": "operational",
        "schema_org": "Product + Offer",
        "path": "app/(public)/livros/[slug]"
      },
      {
        "name": "Listas SEO",
        "status": "operational",
        "schema_org": "ItemList + Book",
        "path": "app/(public)/listas/[slug]"
      },
      {
        "name": "Categorias (Taxonomia)",
        "status": "operational",
        "schema_org": "CollectionPage",
        "path": "app/(public)/categorias/[slug]"
      },
      {
        "name": "Hub Categorias",
        "status": "operational",
        "path": "app/(public)/categorias"
      },
      {
        "name": "Página de Ofertas",
        "status": "operational",
        "schema_org": "ItemList + Product + Offer",
        "path": "app/(public)/ofertas"
      },
      {
        "name": "Click Tracking",
        "status": "operational",
        "path": "app/(internal)/api/click/[id]"
      }
    ]
  },

  "monetization": {
    "model": "affiliate_redirect",
    "status": "functional",
    "flows": [
      "Lista → Livro",
      "Livro → Oferta",
      "Oferta → Afiliado"
    ]
  },

  "tracking": {
    "status": "implemented",
    "table": "oferta_clicks",
    "deduplication": "pending"
  },

  "interlinking": {
    "implemented": [
      "Lista → Livro",
      "Livro → Lista",
      "Livro → Oferta",
      "Oferta → Livro",
      "Lista ↔ Lista",
      "Livro → Categoria",
      "Categoria → Livro",
      "Categoria → Listas (auto)",
      "Categoria → Listas (editorial layer ready)"
    ],
    "pending": [
      "Livro → Livros relacionados",
      "Autor → Livro",
      "Aggregate relevance ordering"
    ]
  },

  "taxonomy": {
    "status": "active",
    "layers": {
      "livros_categorias": "operational",
      "listas_categorias": "operational_empty",
      "inferencia_automatica": "operational"
    },
    "ordering": {
      "pivot_weight": true,
      "editorial_priority": true
    }
  },

  "seo_structured_data": {
    "livro_page": "Product + Offer",
    "listas_page": "ItemList + Book",
    "ofertas_page": "ItemList + Product + Offer",
    "categorias_page": "CollectionPage",
    "aggregate_offer": "pending"
  },

  "data_layer": {
    "production": {
      "provider": "Supabase",
      "status": "connected",
      "rls_public_read": true
    },
    "staging": {
      "provider": "SQLite",
      "role": "Ingest + Enrichment + QA + Dedup",
      "status": "operational"
    }
  },

  "ingest_pipeline": {
    "status": "operational_incremental",

    "execution": {
      "entrypoint": "scripts/main.py",
      "mode": "menu_driven",
      "interrupt_resume": true,
      "heartbeat": "30s",
      "logging": "timestamped_terminal"
    },

    "state_management": {
      "progress_storage": "SQLite",
      "granularity": [
        "per_step",
        "per_record",
        "per_batch"
      ],
      "resume_strategy": "auto_continue_from_last_offset"
    },

    "cluster_strategy": {
      "type": "library_grade_taxonomy",
      "scope": "expanded_exhaustive",
      "languages_supported": [
        "Portuguese",
        "English",
        "Spanish",
        "Italian"
      ]
    },

    "steps": [
      { "order": 1, "name": "Prospect", "status": "operational" },
      { "order": 2, "name": "Slugify", "status": "operational" },
      { "order": 3, "name": "Deduplicate", "status": "operational" },
      { "order": 4, "name": "Synopsis Generation", "status": "operational" },
      { "order": 5, "name": "Synopsis Review", "status": "operational" },
      { "order": 6, "name": "Cover Enrichment", "status": "operational" },
      {
        "order": 7,
        "name": "Publish",
        "status": "operational_with_blocker",
        "blocker": "uuid_format_mismatch"
      }
    ]
  },

  "validated_routes": [
    "/",
    "/livros",
    "/livros/[slug]",
    "/listas/[slug]",
    "/categorias",
    "/categorias/[slug]",
    "/ofertas"
  ],

  "open_tasks": [
    {
      "id": "TASK-TRACK-001",
      "description": "Deduplicação de cliques afiliados",
      "priority": "medium"
    },
    {
      "id": "TASK-SEO-003",
      "description": "AggregateOffer por livro",
      "priority": "medium"
    },
    {
      "id": "TASK-INGEST-UUID-004",
      "description": "Normalizar UUID entre SQLite e Supabase"
